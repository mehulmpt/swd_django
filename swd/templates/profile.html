{% extends 'base.html' %}
{% block content %}

<div>
    <div class="section">

        <!--   Icon Section   -->
        <div class="row">
            <div class="col s6 l6">
                <div class="card">
                    <div class="card-content">
                        <span class="card-title">My Profile</span>
                        <table class="striped">
                            <tbody>
                                <tr>
                                    <td>Name</td>
                                    <td>{{ student.name }}</td>

                                </tr>
                                <tr>
                                    <td>BITS ID:</td>
                                    <td>{{ student.bitsId }}</td>

                                </tr>
                                <tr>
                                    <td>DOB</td>
                                    <td>{{ student.dob }}</td>
                                </tr>
                                <tr>
                                    <td>Address</td>
                                    <td> <span class="left addressval">{{ student.address }} </span> <span class="new badge red comm left editAddr" data-badge-caption="">Edit</span> </td>
                                </tr>
                                <tr>
                                    <td>CGPA</td>
                                    <td>{{ student.cgpa }}</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            {% if student.profile_picture %}
            <div class="col s3 l3">
                <div class="card">
                    <div class="card-content">
                        <div><img style="width:100%" src="/media/{{ student.profile_picture }}"></div>
                    </div>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
    <br><br>
</div>

<style>
  .comm {
    width:100px;
  }
  .editAddr, .saveAddr {
    cursor: pointer;
  }
  .details th:nth-child(1), .details td:nth-child(1) {
    width: 35%;
  }
  .details th:nth-child(2), .details td:nth-child(2) {
    width: 65%;
  }
</style>
{% csrf_token %}
<script>
  $(document).on('click', '.editAddr', (e) => {
    $('.editAddr').addClass('saveAddr').removeClass('editAddr').text('Save').removeClass('red').addClass('green')
    $('.addressval').attr('contenteditable', true)
    $('.addressval').focus()
  })

  $(document).on('click', '.saveAddr', (e) => {
    $('.saveAddr').addClass('editAddr').removeClass('saveAddr').text('Edit').removeClass('green').addClass('red')
    $('.addressval').removeAttr('contenteditable')
    $('.addressval').blur()

    const newAddr = $('.addressval').text()

    $.post('/profile/', {
      address: newAddr,
      csrfmiddlewaretoken: $('[name="csrfmiddlewaretoken"]').val()
    })
  })
</script>

{% endblock %}